define("echarts/chart/venn",["require","./base","zrender/shape/Text","zrender/shape/Circle","zrender/shape/Path","../config","../util/ecData","zrender/tool/util","../chart"],function(t){function e(t,e,s,i,h){a.call(this,t,e,s,i,h),this.refresh(i)}var a=t("./base"),s=t("zrender/shape/Text"),i=t("zrender/shape/Circle"),h=t("zrender/shape/Path"),r=t("../config");r.venn={zlevel:0,z:1,calculable:!1};var l=t("../util/ecData"),n=t("zrender/tool/util");return e.prototype={type:r.CHART_TYPE_VENN,_buildShape:function(){this.selectedMap={},this._symbol=this.option.symbolList,this._queryTarget,this._dropBoxList=[],this._vennDataCounter=0;var t=this.series;this.data=t[0].data,this._buildVenn(this.data),this.addShapeList()},_buildVenn:function(t){var e,a;t[0].value>t[1].value?(e=this.zr.getHeight()/3,a=e*Math.sqrt(t[1].value)/Math.sqrt(t[0].value)):(a=this.zr.getHeight()/3,e=a*Math.sqrt(t[0].value)/Math.sqrt(t[1].value));var s=this.zr.getWidth()/2-e,i=(e+a)/2*Math.sqrt(t[2].value)/Math.sqrt((t[0].value+t[1].value)/2),h=e+a;0!==t[2].value&&(h=this._getCoincideLength(t[0].value,t[1].value,t[2].value,e,a,i,Math.abs(e-a),e+a));var r=s+h,l=this.zr.getHeight()/2;if(this._buildItem(0,0,s,l,e),this._buildItem(0,1,r,l,a),0!==t[2].value&&t[2].value!==t[0].value&&t[2].value!==t[1].value){var n=(e*e-a*a)/(2*h)+h/2,o=h/2-(e*e-a*a)/(2*h),u=Math.sqrt(e*e-n*n),c=0,p=0;t[0].value>t[1].value&&s+n>r&&(p=1),t[0].value<t[1].value&&s+o>r&&(c=1),this._buildCoincideItem(2,s+n,l-u,l+u,e,a,c,p)}},_getCoincideLength:function(t,e,a,s,i,h,r,l){var n=(s*s-i*i)/(2*h)+h/2,o=h/2-(s*s-i*i)/(2*h),u=Math.acos(n/s),c=Math.acos(o/i),p=s*s*Math.PI,f=u*s*s-n*s*Math.sin(u)+c*i*i-o*i*Math.sin(c),v=f/p,d=a/t,g=Math.abs(v/d);return g>.999&&1.001>g?h:.999>=g?(l=h,h=(h+r)/2,this._getCoincideLength(t,e,a,s,i,h,r,l)):(r=h,h=(h+l)/2,this._getCoincideLength(t,e,a,s,i,h,r,l))},_buildItem:function(t,e,a,s,i){var h=this.series,r=this.getCircle(e,a,s,i);if(l.pack(r,h[0],t,h[0].data[e],e,h[0].data[e].name),this.shapeList.push(r),h[0].itemStyle.normal.label.show){var n=this.getLabel(e,a,s,i);l.pack(n,h[0],t,h[0].data[e],e,h[0].data[e].name),this.shapeList.push(n)}},_buildCoincideItem:function(t,e,a,s,i,r,n,o){var u=this.series,c=u[0],p=this.data[t],f=[p,c],v=this.deepMerge(f,"itemStyle.normal")||{},d=this.deepMerge(f,"itemStyle.emphasis")||{},g=v.color||this.zr.getColor(t),b=d.color||this.zr.getColor(t),m="M"+e+","+a+"A"+i+","+i+",0,"+n+",1,"+e+","+s+"A"+r+","+r+",0,"+o+",1,"+e+","+a,M={color:g,path:m},y={zlevel:this.getZlevelBase(),z:this.getZBase(),style:M,highlightStyle:{color:b,lineWidth:d.borderWidth,strokeColor:d.borderColor}};y=new h(y),y.buildPathArray&&(y.style.pathArray=y.buildPathArray(M.path)),l.pack(y,u[0],0,u[0].data[t],t,u[0].data[t].name),this.shapeList.push(y)},getCircle:function(t,e,a,s){var h=this.series[0],r=this.data[t],l=[r,h],n=this.deepMerge(l,"itemStyle.normal")||{},o=this.deepMerge(l,"itemStyle.emphasis")||{},u=n.color||this.zr.getColor(t),c=o.color||this.zr.getColor(t),p={zlevel:this.getZlevelBase(),clickable:!0,style:{x:e,y:a,r:s,brushType:"fill",opacity:1,color:u},highlightStyle:{color:c,lineWidth:o.borderWidth,strokeColor:o.borderColor}};return this.deepQuery([r,h,this.option],"calculable")&&(this.setCalculable(p),p.draggable=!0),new i(p)},getLabel:function(t,e,a,i){var h=this.series[0],l=h.itemStyle,n=this.data[t],o=[n,h],u=this.deepMerge(o,"itemStyle.normal")||{},c="normal",p=l[c].label,f=p.textStyle||{},v=this.getLabelText(t,c),d=this.getFont(f),g=u.color||this.zr.getColor(t),b=f.fontSize||12,m={zlevel:r.venn.zlevel+1,style:{x:e,y:a-i-b,color:f.color||g,text:v,textFont:d,textAlign:"center"}};return new s(m)},getLabelText:function(t,e){var a=this.series,s=a[0],i=s.data[t],h=this.deepQuery([i,s],"itemStyle."+e+".label.formatter");return h?"function"==typeof h?h(s.name,i.name,i.value):"string"==typeof h?(h=h.replace("{a}","{a0}").replace("{b}","{b0}").replace("{c}","{c0}"),h=h.replace("{a0}",s.name).replace("{b0}",i.name).replace("{c0}",i.value)):void 0:i.name},refresh:function(t){t&&(this.option=t,this.series=t.series),this._buildShape()}},n.inherits(e,a),t("../chart").define("venn",e),e}),define("zrender/shape/Path",["require","./Base","./util/PathProxy","../tool/util"],function(t){var e=t("./Base"),a=t("./util/PathProxy"),s=a.PathSegment,i=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},h=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(i(t)*i(e))},r=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(h(t,e))},l=function(t){e.call(this,t)};return l.prototype={type:"path",buildPathArray:function(t,e,a){if(!t)return[];e=e||0,a=a||0;var i=t,h=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];i=i.replace(/-/g," -"),i=i.replace(/  /g," "),i=i.replace(/ /g,","),i=i.replace(/,,/g,",");var r;for(r=0;r<h.length;r++)i=i.replace(new RegExp(h[r],"g"),"|"+h[r]);var l=i.split("|"),n=[],o=0,u=0;for(r=1;r<l.length;r++){var c=l[r],p=c.charAt(0);c=c.slice(1),c=c.replace(new RegExp("e,-","g"),"e-");var f=c.split(",");f.length>0&&""===f[0]&&f.shift();for(var v=0;v<f.length;v++)f[v]=parseFloat(f[v]);for(;f.length>0&&!isNaN(f[0]);){var d,g,b,m,M,y,_,C,A=null,L=[],z=o,k=u;switch(p){case"l":o+=f.shift(),u+=f.shift(),A="L",L.push(o,u);break;case"L":o=f.shift(),u=f.shift(),L.push(o,u);break;case"m":o+=f.shift(),u+=f.shift(),A="M",L.push(o,u),p="l";break;case"M":o=f.shift(),u=f.shift(),A="M",L.push(o,u),p="L";break;case"h":o+=f.shift(),A="L",L.push(o,u);break;case"H":o=f.shift(),A="L",L.push(o,u);break;case"v":u+=f.shift(),A="L",L.push(o,u);break;case"V":u=f.shift(),A="L",L.push(o,u);break;case"C":L.push(f.shift(),f.shift(),f.shift(),f.shift()),o=f.shift(),u=f.shift(),L.push(o,u);break;case"c":L.push(o+f.shift(),u+f.shift(),o+f.shift(),u+f.shift()),o+=f.shift(),u+=f.shift(),A="C",L.push(o,u);break;case"S":d=o,g=u,b=n[n.length-1],"C"===b.command&&(d=o+(o-b.points[2]),g=u+(u-b.points[3])),L.push(d,g,f.shift(),f.shift()),o=f.shift(),u=f.shift(),A="C",L.push(o,u);break;case"s":d=o,g=u,b=n[n.length-1],"C"===b.command&&(d=o+(o-b.points[2]),g=u+(u-b.points[3])),L.push(d,g,o+f.shift(),u+f.shift()),o+=f.shift(),u+=f.shift(),A="C",L.push(o,u);break;case"Q":L.push(f.shift(),f.shift()),o=f.shift(),u=f.shift(),L.push(o,u);break;case"q":L.push(o+f.shift(),u+f.shift()),o+=f.shift(),u+=f.shift(),A="Q",L.push(o,u);break;case"T":d=o,g=u,b=n[n.length-1],"Q"===b.command&&(d=o+(o-b.points[0]),g=u+(u-b.points[1])),o=f.shift(),u=f.shift(),A="Q",L.push(d,g,o,u);break;case"t":d=o,g=u,b=n[n.length-1],"Q"===b.command&&(d=o+(o-b.points[0]),g=u+(u-b.points[1])),o+=f.shift(),u+=f.shift(),A="Q",L.push(d,g,o,u);break;case"A":m=f.shift(),M=f.shift(),y=f.shift(),_=f.shift(),C=f.shift(),z=o,k=u,o=f.shift(),u=f.shift(),A="A",L=this._convertPoint(z,k,o,u,_,C,m,M,y);break;case"a":m=f.shift(),M=f.shift(),y=f.shift(),_=f.shift(),C=f.shift(),z=o,k=u,o+=f.shift(),u+=f.shift(),A="A",L=this._convertPoint(z,k,o,u,_,C,m,M,y)}for(var P=0,x=L.length;x>P;P+=2)L[P]+=e,L[P+1]+=a;n.push(new s(A||p,L))}("z"===p||"Z"===p)&&n.push(new s("z",[]))}return n},_convertPoint:function(t,e,a,s,i,l,n,o,u){var c=u*(Math.PI/180),p=Math.cos(c)*(t-a)/2+Math.sin(c)*(e-s)/2,f=-1*Math.sin(c)*(t-a)/2+Math.cos(c)*(e-s)/2,v=p*p/(n*n)+f*f/(o*o);v>1&&(n*=Math.sqrt(v),o*=Math.sqrt(v));var d=Math.sqrt((n*n*o*o-n*n*f*f-o*o*p*p)/(n*n*f*f+o*o*p*p));i===l&&(d*=-1),isNaN(d)&&(d=0);var g=d*n*f/o,b=d*-o*p/n,m=(t+a)/2+Math.cos(c)*g-Math.sin(c)*b,M=(e+s)/2+Math.sin(c)*g+Math.cos(c)*b,y=r([1,0],[(p-g)/n,(f-b)/o]),_=[(p-g)/n,(f-b)/o],C=[(-1*p-g)/n,(-1*f-b)/o],A=r(_,C);return h(_,C)<=-1&&(A=Math.PI),h(_,C)>=1&&(A=0),0===l&&A>0&&(A-=2*Math.PI),1===l&&0>A&&(A+=2*Math.PI),[m,M,n,o,y,A,c,l]},buildPath:function(t,e){var a=e.path,s=e.x||0,i=e.y||0;e.pathArray=e.pathArray||this.buildPathArray(a,s,i);for(var h=e.pathArray,r=e.pointList=[],l=[],n=0,o=h.length;o>n;n++){"M"==h[n].command.toUpperCase()&&(l.length>0&&r.push(l),l=[]);for(var u=h[n].points,c=0,p=u.length;p>c;c+=2)l.push([u[c],u[c+1]])}l.length>0&&r.push(l);for(var n=0,o=h.length;o>n;n++){var f=h[n].command,u=h[n].points;switch(f){case"L":t.lineTo(u[0],u[1]);break;case"M":t.moveTo(u[0],u[1]);break;case"C":t.bezierCurveTo(u[0],u[1],u[2],u[3],u[4],u[5]);break;case"Q":t.quadraticCurveTo(u[0],u[1],u[2],u[3]);break;case"A":var v=u[0],d=u[1],g=u[2],b=u[3],m=u[4],M=u[5],y=u[6],_=u[7],C=g>b?g:b,A=g>b?1:g/b,L=g>b?b/g:1;t.translate(v,d),t.rotate(y),t.scale(A,L),t.arc(0,0,C,m,m+M,1-_),t.scale(1/A,1/L),t.rotate(-y),t.translate(-v,-d);break;case"z":t.closePath()}}},getRect:function(t){if(t.__rect)return t.__rect;var e;e="stroke"==t.brushType||"fill"==t.brushType?t.lineWidth||1:0;for(var a=Number.MAX_VALUE,s=Number.MIN_VALUE,i=Number.MAX_VALUE,h=Number.MIN_VALUE,r=t.x||0,l=t.y||0,n=t.pathArray||this.buildPathArray(t.path),o=0;o<n.length;o++)for(var u=n[o].points,c=0;c<u.length;c++)c%2===0?(u[c]+r<a&&(a=u[c]),u[c]+r>s&&(s=u[c])):(u[c]+l<i&&(i=u[c]),u[c]+l>h&&(h=u[c]));var p;return p=a===Number.MAX_VALUE||s===Number.MIN_VALUE||i===Number.MAX_VALUE||h===Number.MIN_VALUE?{x:0,y:0,width:0,height:0}:{x:Math.round(a-e/2),y:Math.round(i-e/2),width:s-a+e,height:h-i+e},t.__rect=p,p}},t("../tool/util").inherits(l,e),l});